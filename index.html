<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A brief description of the webpage for search engines.">
    <meta name="author" content="Your Name">
    <title>Estonian map project</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to an external CSS file -->
    <link rel="icon" href="favicon.ico" type="image/x-icon"> <!-- Favicon for the browser tab -->
    <script src="script.js" defer></script> <!-- External JavaScript file -->

 
 
 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
	 
 <!-- Make sure you put this AFTER Leaflet's CSS -->
 <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
	 
</head>

<body>

	<H1> 
	Valitud Eesti m천isad - Selected Estonian manors 
	</H1>
    <H2>
	P천hineb - based on: <a href="https://www.mois.ee">Eesti M천isa Poortal - Estonian manors</a>
	<br>
	Valmistatud - made with: <a href="https://leafletjs.com/">Leaflet Javascript</a>
	</H2>

<div id="map" style="width: 1200px; height: 800px;"></div>
<script src="places-geojson.js" type="text/javascript"></script>

<script>
	const map = L.map('map').setView([58.845017, 25.548706], 8);
	const tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 19,
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
	}).addTo(map);

	//const inputValue = document.getElementById("loc").innerHTML;
	//const inputValue = "59.434358,24.742334";

	const eesti_icon = L.icon({
		iconUrl: 'flag_of_Estonia.png',
		iconSize: [25, 20],
		iconAnchor: [18, 20],
		popupAnchor: [0, -28]
	});	
	
	const tallinn = L.marker([59.433765, 24.744194],{icon: eesti_icon}).addTo(map)
		.bindPopup('<b>Tallinn Vabaduse v채ljak  - Freedom Square<br><a href="../help.html">Abi -- Help</b></a><br>');
	
	const popup = L.popup()
	//	.setLatLng([59.434358,24.742334])
	//	.setContent('Old Town.');

//	function onMapClick(e) {
//		popup
//			.setLatLng(e.latlng)
//			.setContent(`You clicked the map at ${e.latlng.toString()}`)
//			.openOn(map);
//	}


	var googlelink = "";
	var coords = "";
	var link ="";
	var url ="";
	
      map.on('click', function(e) {
	     coords = e.latlng.toString().substring(7,e.latlng.toString().length-1);
		 url = 'https://www.google.com/maps/place/' + coords;
		 link = '<a href="' + url + '" >Google maps</a>';
		 googlelink = coords + '<br>' + link;
		 coords = coords.replace(', ','~');
		 bingurl = 'https://www.bing.com/maps/search?cp=' + coords + '&lvl=15';
	     binglink = '<a href="' + bingurl + '" >Bing maps</a>';

		
      });
	
	function onMapClick(e) {
		popup
			.setLatLng(e.latlng)
			.setContent(googlelink + '<br>' + binglink )
			.openOn(map)
	}
	map.on('click', onMapClick);


function onEachFeature(feature, layer) {
    // does this feature have a property named popupContent?
    if (feature.properties && feature.properties.popupContent) {
        layer.bindPopup(feature.properties.popupContent);
    }
}

	const approximateLayer = L.geoJSON([approximate], {
		style(feature) {
			return feature.properties && feature.properties.style;
		},

		onEachFeature,

		pointToLayer(feature, latlng) {
			return L.circleMarker(latlng, {
				radius: 7,
				fillColor: 'white',
				color: 'black',
				weight: 2,
				opacity: 5,
				fillOpacity: 0.2
			});
		}
	}).addTo(map);
	
	const exactLayer = L.geoJSON([exactloc], {
		style(feature) {
			return feature.properties && feature.properties.style;
		},
		onEachFeature,
		pointToLayer(feature, latlng) {
			return L.circleMarker(latlng, {
				radius: 4,
				fillColor: 'white',
				color: 'blue',
				weight: 2,
				opacity: 5,
				fillOpacity: 0.2
			});
		}
	}).addTo(map);
	
	const squareLayer = L.geoJSON(square, {

		filter(feature, layer) {
			if (feature.properties) {
				// If the property "underConstruction" exists and is true, return false (don't render features under construction)
				return feature.properties.underConstruction !== undefined ? !feature.properties.underConstruction : true;
			}
			return false;
		},

		onEachFeature
	}).addTo(map);

	const knightsicon = L.icon({
		iconUrl: 'livonian_cross_q.bmp',
		iconSize: [20, 25],
		iconAnchor: [18, 20],
		popupAnchor: [0, -28]
	});
	
	const knightsicon_true = L.icon({
		iconUrl: 'livonian_cross_plain.bmp',
		iconSize: [20, 25],
		iconAnchor: [18, 20],
		popupAnchor: [0, -28]
	});	
	
	var knightsLayer = L.geoJSON(knights, {
		pointToLayer(feature, latlng) {
			return L.marker(latlng, {icon: knightsicon});
		},
		onEachFeature
	}).addTo(map);
	
	var knightsLayer_true = L.geoJSON(knights_true, {
		pointToLayer(feature, latlng) {
			return L.marker(latlng, {icon: knightsicon_true});
		},
		onEachFeature
	}).addTo(map);

	
	const kunglaicon = L.icon({
		iconUrl: 'sweden_flag.bmp',
		iconSize: [25, 20],
		iconAnchor: [18, 20],
		popupAnchor: [0, -28]
	});
	
	var kunglaLayer = L.geoJSON(kungla, {
		pointToLayer(feature, latlng) {
			return L.marker(latlng, {icon: kunglaicon});
		},
		onEachFeature
	}).addTo(map);



</script>



</body>

























